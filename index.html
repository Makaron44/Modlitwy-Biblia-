<!DOCTYPE html>
<html lang="pl" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Dziennik modlitw biblijnych â€” 30 dni</title>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0e0f13">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <style>
    :root{ --bg:#0e0f13; --panel:#171923; --muted:#9096a5; --text:#e9edf5; --accent:#7aa2ff;
           --ok:#7ad97a; --border:#2a2f3f; --radius:14px; --day:#131621; --btn:#131621; --header:rgba(14,15,19,.78); }
    html[data-theme="light"]{ --bg:#f6f8fc; --panel:#fff; --muted:#405063; --text:#0b1220; --accent:#1f3aec;
           --ok:#1e8a4d; --border:#cfd7e6; --day:#ffffff; --btn:#ffffff; --header:rgba(255,255,255,.94); }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial;
         padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);}
    header{position:sticky;top:0;z-index:10;background:var(--header);backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
    .wrap{max-width:1000px;margin:0 auto;padding:12px 16px}
    h1{margin:6px 0 2px;font-size:clamp(22px,4vw,30px)}
    .muted{color:var(--muted)} .small{font-size:13px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 0}
    button{appearance:none;border:1px solid var(--border);background:var(--btn);color:var(--text);
           padding:10px 14px;border-radius:12px;font-weight:700}
    main{padding:16px}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin-bottom:12px}
    .kicker{font-size:12px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);font-weight:800;margin-bottom:8px}
    .days{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
    .day{padding:12px;border:1px solid var(--border);background:var(--day);border-radius:12px;cursor:pointer}
    .day h3{margin:0 0 6px;font-size:15px}
    .pill{display:inline-block;border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-size:12px;background:#0f121b}
    html[data-theme="light"] .pill{background:#eef2ff}
    label{display:block;margin:10px 0 6px;font-weight:800}
    textarea{width:100%;min-height:110px;border-radius:12px;border:1px solid var(--border);background:#0f121b;color:var(--text);padding:10px;resize:vertical;font:inherit;line-height:1.6}
    html[data-theme="light"] textarea{background:#fff}
    .hidden{display:none}
    .footer{opacity:.75;font-size:12px;text-align:center;margin-top:10px}
    /* Tabela Å›ciÄ…gi */
    .grid2{display:grid;grid-template-columns:1fr;gap:12px}
    @media(min-width:760px){ .grid2{grid-template-columns:1fr 1fr} }
    table{width:100%;border-collapse:separate;border-spacing:0;overflow:hidden;border:1px solid var(--border);border-radius:12px}
    th,td{padding:10px 12px;border-bottom:1px solid var(--border)}
    th{font-size:12px;letter-spacing:.08em;text-transform:uppercase;color:var(--muted);text-align:left;background:rgba(255,255,255,.02)}
    tr:last-child td{border-bottom:0}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Dziennik modlitw biblijnych â€” 30 dni</h1>
      <div class="muted small">Offline â€¢ zapis lokalny â€¢ jasny/ciemny â€¢ PWA â€¢ eksport/import</div>
      <div class="toolbar">
        <button id="themeBtn" type="button">Tryb: <span id="themeLabel">ciemny</span></button>
        <button id="exportBtn" type="button">Eksport danych</button>
        <input type="file" id="importFile" accept="application/json" style="display:none">
        <button id="importBtn" type="button">Import danych</button>
        <button id="resetBtn" type="button">WyczyÅ›Ä‡</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- LISTA DNI -->
    <section class="panel">
      <div class="kicker">Lista dni</div>
      <div id="days" class="days"></div>
    </section>

    <!-- SZCZEGÃ“ÅY -->
    <section class="panel">
      <div class="kicker">SzczegÃ³Å‚y</div>
      <h2 id="dayTitle">Wybierz dzieÅ„</h2>
      <p class="muted small">Najpierw znajdÅº podany fragment w swojej Biblii, przeczytaj go, a poniÅ¼ej wpisz wÅ‚asnÄ… modlitwÄ™ lub wklej wybrane tÅ‚umaczenia.</p>

      <div id="detail" class="hidden">
        <div id="refTag" style="margin:6px 0 12px"></div>

        <label for="myPrayer">Moja modlitwa</label>
        <textarea id="myPrayer" placeholder="Twoja osobista modlitwa na podstawie przeczytanego fragmentu..."></textarea>

        <label for="translations">Inne tÅ‚umaczenia / cytaty</label>
        <textarea id="translations" placeholder="Tu moÅ¼esz wkleiÄ‡ rÃ³Å¼ne tÅ‚umaczenia lub wersje, ktÃ³re chcesz porÃ³wnaÄ‡."></textarea>

        <label for="notes">Notatki</label>
        <textarea id="notes" placeholder="MyÅ›li, sÅ‚owa kluczowe, decyzje..."></textarea>

        <div class="toolbar" style="margin-top:10px">
          <button id="saveBtn" type="button" style="background:var(--accent);color:#fff;border-color:transparent">Zapisz</button>
          <button id="doneBtn" type="button">Oznacz jako zrobione</button>
          <span id="status" class="muted small"></span>
        </div>
      </div>
    </section>

    <!-- ÅšCIÄ„GA â€“ SKRÃ“TY -->
    <section class="panel">
      <div class="kicker">ÅšciÄ…ga</div>
      <h2 style="margin-top:0">SkrÃ³ty ksiÄ…g biblijnych</h2>
      <p class="muted small">Szybka pomoc do odnajdywania skrÃ³tÃ³w w planie.</p>

      <div class="grid2">
        <div>
          <h3>ğŸ“– Stary Testament</h3>
          <table>
            <thead><tr><th>SkrÃ³t</th><th>PeÅ‚na nazwa</th></tr></thead>
            <tbody id="tblOT"></tbody>
          </table>
        </div>
        <div>
          <h3>ğŸ“– Nowy Testament</h3>
          <table>
            <thead><tr><th>SkrÃ³t</th><th>PeÅ‚na nazwa</th></tr></thead>
            <tbody id="tblNT"></tbody>
          </table>
        </div>
      </div>
    </section>

    <div class="footer">Dane sÄ… przechowywane lokalnie na tym urzÄ…dzeniu (localStorage). UÅ¼yj â€Eksport danychâ€, aby zrobiÄ‡ kopiÄ™ zapasowÄ….</div>
  </main>

  <script>
    (function(){
      // 30 dni â€“ etykiety
      var DAYS = [
        "1 Sm 2,1â€“10 â€” Modlitwa Anny",
        "2 Sm 7,18â€“29 â€” Modlitwa Dawida",
        "1 Krl 8,22â€“53 â€” Modlitwa Salomona",
        "2 Krl 19,15â€“19 â€” Modlitwa Ezechiasza",
        "Ne 1,5â€“11 â€” Modlitwa Nehemiasza",
        "Dn 2,20â€“23 â€” DziÄ™kczynienie Daniela",
        "Dn 9,3â€“19 â€” Wyznanie i proÅ›ba Daniela",
        "Jon 2,3â€“10 â€” Modlitwa Jonasza",
        "Hab 3,1â€“19 â€” Modlitwa Habakuka",
        "Ps 23 â€” UfnoÅ›Ä‡ Panu",
        "Ps 51 â€” Pokuta Dawida",
        "Ps 63 â€” TÄ™sknota za Bogiem",
        "Ps 91 â€” Pod opiekÄ… NajwyÅ¼szego",
        "Ps 139 â€” BÃ³g mnie zna",
        "1 Krn 4,10 â€” Modlitwa Jabesa",
        "Åk 1,46â€“55 â€” Magnificat (Maryja)",
        "Åk 1,68â€“79 â€” Benedictus (Zachariasz)",
        "Åk 2,29â€“32 â€” Nunc dimittis (Symeon)",
        "Mt 6,9â€“13 â€” Modlitwa PaÅ„ska",
        "J 17,1â€“26 â€” Modlitwa Jezusa",
        "Dz 4,24â€“30 â€” O odwagÄ™ dla wspÃ³lnoty",
        "Dz 7,59â€“60 â€” Modlitwa Szczepana",
        "Rz 11,33â€“36 â€” Uwielbienie PawÅ‚a",
        "Rz 15,5â€“6.13 â€” O jednoÅ›Ä‡ i nadziejÄ™",
        "Ef 1,15â€“23 â€” O poznanie Boga",
        "Ef 3,14â€“21 â€” O umocnienie w wierze",
        "Flp 1,3â€“11 â€” DziÄ™kczynienie PawÅ‚a",
        "Kol 1,9â€“14 â€” O mÄ…droÅ›Ä‡ i siÅ‚Ä™",
        "1 Tes 3,11â€“13 â€” O miÅ‚oÅ›Ä‡ i Å›wiÄ™toÅ›Ä‡",
        "Ap 22,20 â€” â€PrzyjdÅº, Panie Jezuâ€"
      ];

      // ÅšciÄ…ga â€“ ST i NT
      var OT = [
        ["Rdz","KsiÄ™ga Rodzaju"],["Wj","KsiÄ™ga WyjÅ›cia"],["KpÅ‚","KsiÄ™ga KapÅ‚aÅ„ska"],["Lb","KsiÄ™ga Liczb"],["Pwt","KsiÄ™ga PowtÃ³rzonego Prawa"],
        ["Joz","KsiÄ™ga Jozuego"],["Sdz","KsiÄ™ga SÄ™dziÃ³w"],["Rt","KsiÄ™ga Rut"],["1 Sm","1. KsiÄ™ga Samuela"],["2 Sm","2. KsiÄ™ga Samuela"],
        ["1 Krl","1. KsiÄ™ga KrÃ³lewska"],["2 Krl","2. KsiÄ™ga KrÃ³lewska"],["1 Krn","1. KsiÄ™ga Kronik"],["2 Krn","2. KsiÄ™ga Kronik"],
        ["Ezd","KsiÄ™ga Ezdrasza"],["Ne","KsiÄ™ga Nehemiasza"],["Tb","KsiÄ™ga Tobiasza"],["Jdt","KsiÄ™ga Judyty"],["Est","KsiÄ™ga Estery"],
        ["1 Mch","1. KsiÄ™ga Machabejska"],["2 Mch","2. KsiÄ™ga Machabejska"],["Hi","KsiÄ™ga Hioba"],["Ps","KsiÄ™ga PsalmÃ³w"],
        ["Prz","KsiÄ™ga PrzysÅ‚Ã³w"],["Koh","KsiÄ™ga Koheleta"],["Pnp","PieÅ›Å„ nad PieÅ›niami"],["Mdr","KsiÄ™ga MÄ…droÅ›ci"],["Syr","KsiÄ™ga Syracha"],
        ["Iz","KsiÄ™ga Izajasza"],["Jr","KsiÄ™ga Jeremiasza"],["Lm","Lamentacje"],["Ba","KsiÄ™ga Barucha"],["Ez","KsiÄ™ga Ezechiela"],
        ["Dn","KsiÄ™ga Daniela"],["Oz","KsiÄ™ga Ozeasza"],["Jl","KsiÄ™ga Joela"],["Am","KsiÄ™ga Amosa"],["Ab","KsiÄ™ga Abdiasza"],
        ["Jon","KsiÄ™ga Jonasza"],["Mi","KsiÄ™ga Micheasza"],["Na","KsiÄ™ga Nahuma"],["Ha","KsiÄ™ga Habakuka"],["So","KsiÄ™ga Sofoniasza"],
        ["Ag","KsiÄ™ga Aggeusza"],["Za","KsiÄ™ga Zachariasza"],["Ml","KsiÄ™ga Malachiasza"]
      ];
      var NT = [
        ["Mt","Ewangelia wg Å›w. Mateusza"],["Mk","Ewangelia wg Å›w. Marka"],["Åk","Ewangelia wg Å›w. Åukasza"],["J","Ewangelia wg Å›w. Jana"],
        ["Dz","Dzieje Apostolskie"],["Rz","List do Rzymian"],["1 Kor","1. List do Koryntian"],["2 Kor","2. List do Koryntian"],
        ["Ga","List do GalatÃ³w"],["Ef","List do Efezjan"],["Flp","List do Filipian"],["Kol","List do Kolosan"],
        ["1 Tes","1. List do Tesaloniczan"],["2 Tes","2. List do Tesaloniczan"],["1 Tm","1. List do Tymoteusza"],["2 Tm","2. List do Tymoteusza"],
        ["Tt","List do Tytusa"],["Flm","List do Filemona"],["Hbr","List do HebrajczykÃ³w"],["Jk","List Å›w. Jakuba"],
        ["1 P","1. List Å›w. Piotra"],["2 P","2. List Å›w. Piotra"],["1 J","1. List Å›w. Jana"],["2 J","2. List Å›w. Jana"],
        ["3 J","3. List Å›w. Jana"],["Jud","List Å›w. Judy"],["Ap","Apokalipsa Å›w. Jana"]
      ];

      var STORAGE = "pj_state_v2";
      var THEMEKEY = "pj_theme";

      function qs(id){ return document.getElementById(id); }
      function save(state){ localStorage.setItem(STORAGE, JSON.stringify(state)); setStatus("Zapisano âœ”"); }
      function load(){ try{ return JSON.parse(localStorage.getItem(STORAGE)) || {}; } catch(e){ return {}; } }
      function setStatus(t){ var s=qs("status"); s.textContent=t; setTimeout(function(){ s.textContent=""; }, 1500); }

      var state = load(), cur = null;

      function renderDays(){
        var box = qs("days"); box.innerHTML = "";
        for (var i=0;i<DAYS.length;i++){
          var n=i+1, label=DAYS[i], key="d"+n, done = state[key] && state[key].done;
          var card = document.createElement("div"); card.className="day"; if(done) card.style.borderColor="var(--ok)";
          var h = document.createElement("h3"); h.textContent="DzieÅ„ "+n+": "+label;
          var ref = document.createElement("div"); ref.innerHTML='<span class="pill">'+ label.split(" â€” ")[0] +'</span>';
          card.appendChild(h); card.appendChild(ref);
          (function(n){ card.addEventListener("click", function(){ openDay(n); }); })(n);
          box.appendChild(card);
        }
      }

      function openDay(n){
        cur = n; var label = DAYS[n-1], key="d"+n;
        qs("dayTitle").textContent = "DzieÅ„ " + n + " â€” " + label;
        qs("refTag").innerHTML = '<span class="pill">'+ label.split(" â€” ")[0] +'</span>';
        qs("myPrayer").value = (state[key] && state[key].myPrayer) || "";
        qs("translations").value = (state[key] && state[key].translations) || "";
        qs("notes").value = (state[key] && state[key].notes) || "";
        qs("doneBtn").textContent = (state[key] && state[key].done) ? "Oznacz jako niezrobione" : "Oznacz jako zrobione";
        qs("detail").classList.remove("hidden");
      }

      // Zapisy
      qs("saveBtn").addEventListener("click", function(){
        if(!cur) return; var key="d"+cur;
        state[key]=state[key]||{};
        state[key].myPrayer=qs("myPrayer").value;
        state[key].translations=qs("translations").value;
        state[key].notes=qs("notes").value;
        save(state); renderDays();
      });
      qs("doneBtn").addEventListener("click", function(){
        if(!cur) return; var key="d"+cur;
        state[key]=state[key]||{}; state[key].done=!state[key].done;
        save(state); renderDays(); openDay(cur);
      });

      // Tema
      function applyTheme(t){ document.documentElement.setAttribute("data-theme", t); qs("themeLabel").textContent=(t==="light")?"jasny":"ciemny"; localStorage.setItem(THEMEKEY,t); }
      function toggleTheme(){ var t=localStorage.getItem(THEMEKEY)||"dark"; applyTheme(t==="dark"?"light":"dark"); }
      qs("themeBtn").addEventListener("click", toggleTheme);
      applyTheme(localStorage.getItem(THEMEKEY) || (window.matchMedia && window.matchMedia("(prefers-color-scheme: light)").matches ? "light":"dark"));

      // Eksport / Import / Reset
      qs("exportBtn").addEventListener("click", function(){
        var blob=new Blob([JSON.stringify(state,null,2)],{type:"application/json"});
        var url=URL.createObjectURL(blob); var a=document.createElement("a"); a.href=url; a.download="dziennik_modlitw_dane.json"; a.click(); URL.revokeObjectURL(url);
      });
      qs("importBtn").addEventListener("click", function(){ qs("importFile").click(); });
      qs("importFile").addEventListener("change", function(e){
        var f=e.target.files[0]; if(!f) return;
        var r=new FileReader();
        r.onload=function(){ try{ var data=JSON.parse(r.result); if(data&&typeof data==="object"){ state=data; save(state); renderDays(); alert("Zaimportowano dane."); } else alert("NieprawidÅ‚owy plik JSON."); }catch(err){ alert("BÅ‚Ä…d importu JSON."); } };
        r.readAsText(f);
      });
      qs("resetBtn").addEventListener("click", function(){
        if(confirm("UsunÄ…Ä‡ wszystkie lokalne dane?")){ localStorage.removeItem(STORAGE); state={}; cur=null; renderDays(); qs("detail").classList.add("hidden"); qs("dayTitle").textContent="Wybierz dzieÅ„"; }
      });

      // Render Å›ciÄ…gi
      function renderTable(arr, tbodyId){
        var tb = document.getElementById(tbodyId); tb.innerHTML="";
        arr.forEach(function(row){
          var tr=document.createElement("tr");
          var td1=document.createElement("td"); td1.textContent=row[0];
          var td2=document.createElement("td"); td2.textContent=row[1];
          tr.appendChild(td1); tr.appendChild(td2); tb.appendChild(tr);
        });
      }
      renderTable(OT, "tblOT");
      renderTable(NT, "tblNT");

      // SW
      if('serviceWorker' in navigator){
        window.addEventListener('load', function(){ navigator.serviceWorker.register('./sw.js').catch(function(){}); });
      }

      renderDays();
    })();
  </script>
</body>
</html>